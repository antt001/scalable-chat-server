(this["webpackJsonpchat-client"]=this["webpackJsonpchat-client"]||[]).push([[0],{128:function(e,t){},131:function(e,t,a){},150:function(e,t,a){},151:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(23),c=a.n(o),s=a(18),i=(a(94),a(84)),l=a(170),u=a(20),m=a(85),d=function(e){sessionStorage.setItem("token",e)},f=function(){return sessionStorage.getItem("token")},p=function(e){var t=e.component,a=Object(m.a)(e,["component"]);return r.a.createElement(u.b,Object.assign({},a,{render:function(e){return f()?r.a.createElement(t,e):r.a.createElement(u.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},g=a(4),E=a(3),b=a(46),h=a.n(b),v=a(166),w=a(168),j=a(81),O=a.n(j),y=a(82),x=a.n(y),S=(a(131),["#e21400","#91580f","#f8a700","#f78b00","#58dc00","#287b00","#a8f07a","#4ae8c4","#3b88eb","#3824aa","#a700ff","#d300e7"]);function k(e){for(var t=7,a=0;a<e.length;a++)t=e.charCodeAt(a)+(t<<5)-t;var n=Math.abs(t%S.length);return S[n]}var N=function(e){return r.a.createElement("span",{className:"username",style:{color:k(e.username)}},e.username,":\xa0")},C=function(e){return r.a.createElement("span",{className:"messageBody"},e.text)},q=function(e){var t=e.username,a=e.text,n=e.isSelfMessage,o=void 0!==n&&n;return r.a.createElement("li",{className:"message"},r.a.createElement("div",{style:{textAlign:o?"left":"right"}},r.a.createElement(N,{username:t}),r.a.createElement(C,{text:a})))},P=function(e){var t=e.text;return r.a.createElement("li",{className:"log"},t)},L=function(e){var t=Object(n.useState)(2),a=Object(E.a)(t,2),o=a[0],c=a[1],s=Object(n.useState)(""),i=Object(E.a)(s,2),l=i[0],u=i[1],m=Object(n.useState)([{type:"log",text:"Hello World"}]),d=Object(E.a)(m,2),p=d[0],b=d[1],j=function(e){var t=Object(n.useState)(),a=Object(E.a)(t,2),r=a[0],o=a[1],c=Object(n.useState)(!0),s=Object(E.a)(c,2),i=s[0],l=s[1],u=Object(n.useState)(),m=Object(E.a)(u,2),d=m[0],p=m[1];return Object(n.useEffect)((function(){var e=h()();e.on("connect",(function(){console.log("connect"),e.emit("authentication",{token:f()})})),e.on("disconnect",(function(){l(!1),p({msg:"disconnected"})})),e.on("authenticated",(function(t){console.log(t),e.username=t,o(e),l(!1)})),e.on("unauthorized",(function(e){l(!1),p({msg:"unauthorized"})}))}),[]),{socket:r,isConnecting:i,error:d}}(),y=j.socket,S=j.isConnecting,k=j.error;k&&console.log(k);var N=function(e){b((function(t){return[].concat(Object(g.a)(t),[{type:"chatMessage",text:e.message,username:e.username}])}))};Object(n.useEffect)((function(){console.log("useEffect"),y&&(y.on("new message",N),y.on("my-name-is",(function(e){b((function(t){return[].concat(Object(g.a)(t),[{type:"log",text:"You are connected to server "+e}])}))})),y.on("blast",(function(e){b((function(t){return[].concat(Object(g.a)(t),[{type:"log",text:"Got blast from "+e.username}])}))})),y.on("spin",(function(e){b((function(t){return[].concat(Object(g.a)(t),[{type:"log",text:"Got spin from "+e.username}])}))})),y.on("wild",(function(e){b((function(t){return[].concat(Object(g.a)(t),[{type:"log",text:"Got wild from "+e.username}])}))})))}),[y]);return S?r.a.createElement("div",null,"Loading.."):r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"buttonsContainer"},r.a.createElement(v.a,{variant:"contained",color:"primary",onClick:function(e){y.emit("spin")}},"SPIN"),r.a.createElement(w.a,{color:"primary",component:"span",onClick:function(){return c((function(e){return e+1}))}},r.a.createElement(O.a,null)),r.a.createElement(v.a,{variant:"contained",color:"primary",onClick:function(e){y.emit("wild",o)}},"WILD(",o,")"),r.a.createElement(w.a,{color:"primary",component:"span",onClick:function(){return c((function(e){return e-1}))}},r.a.createElement(x.a,null)),r.a.createElement(v.a,{variant:"contained",color:"primary",onClick:function(e){y.emit("blast")}},"BLAST")),r.a.createElement("div",{className:"chatArea"},r.a.createElement("ul",{className:"messages"},p&&p.map((function(e,t){return"log"===e.type?r.a.createElement(P,{key:t,text:e.text}):r.a.createElement(q,{key:t,username:e.username,text:e.text,isSelfMessage:"selfMessage"===e.type})}))),r.a.createElement("input",{className:"inputMessage",value:l,placeholder:"Type here...",onChange:function(e){u(e.target.value)},onKeyDown:function(e){13==e.keyCode&&(console.log("value",e.target.value),b((function(e){return[].concat(Object(g.a)(e),[{type:"selfMessage",text:l,username:y.username}])})),y.emit("new message",l),u(""))}})))},M=function(){return r.a.createElement(L,null)},T=a(39),W=a(169),A=function(e){var t=Object(n.useState)(),a=Object(E.a)(t,2),r=a[0],o=a[1],c=Object(n.useState)(!1),s=Object(E.a)(c,2),i=s[0],l=s[1],u=Object(n.useState)(),m=Object(E.a)(u,2),d=m[0],f=m[1],p=Object(n.useState)(),g=Object(E.a)(p,2),b=g[0],h=g[1];return[function(t){return l(!0),h(null),e(t).then((function(e){o(e),f(Date.now())})).catch((function(e){h(e)})).finally((function(){l(!1)}))},{data:r,isLoading:i,lastUpdated:d,error:b}]},F=(a(68),a(83)),I=a.n(F).a.create(),B=function(e){return I.post("/register",e)},D=function(e){return I.post("/login",e)},G=Object(u.g)((function(e){var t=Object(T.a)(),a=t.register,n=t.handleSubmit,o=(t.watch,t.errors),c=A(D),i=Object(E.a)(c,2),l=i[0],u=i[1],m=u.isLoading,f=u.data;if(f){var p=f.data;d(p.token),e.history.push("/",{authenticated:!0})}return m?r.a.createElement("div",null,"Loading.."):r.a.createElement(W.a,{maxWidth:"sm"},r.a.createElement("div",{className:"container"},r.a.createElement("form",{onSubmit:n((function(e){l(e)}))},r.a.createElement("label",{htmlFor:"username"},"Username"),r.a.createElement("input",{id:"username",name:"username",ref:a({required:!0})}),o.username&&r.a.createElement("span",{className:"error"},"This field is required"),r.a.createElement("label",{htmlFor:"password"},"Password:"),r.a.createElement("input",{type:"password",id:"password",name:"password","aria-describedby":"password-helper-text",ref:a({required:!0})}),o.password&&r.a.createElement("span",{className:"error"},"This field is required"),r.a.createElement("input",{type:"submit"}),r.a.createElement(s.b,{to:"/register"},"Register new user"))))})),U=Object(u.g)((function(e){var t=Object(T.a)(),a=t.register,n=t.handleSubmit,o=t.watch,c=t.getValues,i=t.errors,l=A(B),m=Object(E.a)(l,2),f=m[0],p=m[1],g=p.isLoading,b=p.data;if(b){var h=b.data;return d(h.token),r.a.createElement(u.a,{to:{pathname:"/",state:{from:e.location}}})}return g?r.a.createElement("div",null,"Loading.."):r.a.createElement(W.a,{maxWidth:"sm"},r.a.createElement("div",{className:"container"},r.a.createElement("form",{onSubmit:n((function(e){f(e),console.log({data:e,v:c()})}))},r.a.createElement("label",{htmlFor:"username"},"Username"),r.a.createElement("input",{id:"username",name:"username",ref:a({required:!0})}),i.username&&r.a.createElement("span",{className:"error"},"This field is required"),r.a.createElement("label",{htmlFor:"password"},"Password:"),r.a.createElement("input",{type:"password",id:"password",name:"password",ref:a({required:!0})}),i.password&&r.a.createElement("span",{className:"error"},"This field is required"),r.a.createElement("label",{htmlFor:"confirmPassword"},"Confirm Password:"),r.a.createElement("input",{type:"password",id:"confirmPassword",name:"confirmPassword",ref:a({required:!0,validate:function(e){return e===o("password")||"Passwords don't match."}})}),i.confirmPassword&&r.a.createElement("span",{className:"error"},i.confirmPassword.message||"This field is required"),r.a.createElement("input",{type:"submit"}),r.a.createElement(s.b,{to:"/login"},"Login"))))})),z=(a(150),Object(i.a)({palette:{type:"dark"},typography:{useNextVariants:!0}})),J=function(){return r.a.createElement(l.a,{theme:z},r.a.createElement("div",{className:"App"},r.a.createElement(u.d,null,r.a.createElement(p,{path:"/",component:M,exact:!0}),r.a.createElement(u.b,{path:"/login",component:G}),r.a.createElement(u.b,{path:"/register",component:U}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(s.a,null,r.a.createElement(J,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},68:function(e,t,a){},89:function(e,t,a){e.exports=a(151)},94:function(e,t,a){}},[[89,1,2]]]);
//# sourceMappingURL=main.7864b66e.chunk.js.map